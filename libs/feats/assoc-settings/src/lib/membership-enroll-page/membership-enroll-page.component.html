<div class="d-flex flex-column align-items-center gap-8 p-8">
  <h1 class="text-2xl font-bold mt-3">Join or Create Association</h1>

  <div class="d-flex justify-content-center flex-wrap gap-4 my-4">
    <kps-button
      [btnColor]="selectedOption() === 'join' ? 'primary' : undefined"
      [variant]="selectedOption() === 'join' ? 'flat' : 'stroked'"
      text="Join Existing"
      (clicked)="selectOption('join')"
      btnAriaLabel="join existing"
    >
    </kps-button>

    <kps-button
      [btnColor]="selectedOption() === 'create' ? 'primary' : undefined"
      [variant]="selectedOption() === 'create' ? 'flat' : 'stroked'"
      text="Create New"
      (clicked)="selectOption('create')"
      btnAriaLabel="create new"
    >
    </kps-button>
  </div>

  @if (selectedOption()) {
  <div class="w-100" [@slideDown]>
    <!-- Join Association Section -->

    @if (selectedOption() === 'join') {
    <div class="py-4 search-wrapper">
      <kps-input-field controlName="search" [controller]="searchControl">
        <mat-icon matPrefix>search</mat-icon>
        <input matInput placeholder="Search associations..." />
      </kps-input-field>

      @if (assocLoading()) {
      <kps-loading-indicator />
      }@else {
      <mat-list>
        @for (association of associations(); track association.id) {
        <mat-list-item>
          <mat-icon matListItemIcon>group</mat-icon>
          <div matListItemTitle>{{ association.name }}</div>
          <div matListItemLine>{{ association.description }}</div>

          <kps-button
            matListItemMeta
            text="Request to Join"
            (clicked)="openJoinReqConfDialog(association)"
            btnAriaLabel="request to join"
            variant="stroked"
            [btnDisabled]="alreadyMember(association.id)"
          >
          </kps-button>
        </mat-list-item>
        }@empty {
        <mat-list-item>No associations yet.</mat-list-item>
        }
      </mat-list>
      }
    </div>
    }
  </div>
  }

  <!-- Create Association Section -->

  @if (selectedOption() === 'create') {
  <div class="space-y-4">
    <kps-create-association-form
      (createFormSubmitted)="createAssociation($event)"
    />
  </div>

  }
</div>
