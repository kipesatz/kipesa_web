<mat-sidenav-container class="sidenav-container">
  <mat-sidenav
    #sidenav
    [mode]="isSmallScreen() ? 'over' : 'side'"
    [opened]="!isSmallScreen()"
    [class.sidenav-expanded]="isExpanded()"
    class="sidenav"
    style="width: 250px !important"
  >
    <section class="d-flex h-100 flex-column overflow-hidden">
      <!-- Logo Section -->
      <div class="logo-container position-sticky top-0">
        <img
          src="kipesa_logo11.png"
          [class.small]="!isExpanded()"
          alt="Kipesa Logo"
        />
      </div>

      <!-- menu items -->
      <div class="flex-grow-1 overflow-x-hidden overflow-y-scroll">
        <div class="sidenav-group">
          <div class="sidenav-group-header">
            <mat-icon>hub</mat-icon>
            <h6 class="sidenav-group-title">core services</h6>
          </div>

          <!-- Back Navigation -->
          @if (navigationStack().length) {
          <mat-toolbar class="back-nav">
            <kps-iconic-button
              btnAriaLabel="go back"
              icon="arrow_back"
              matTooltip="Go back"
              (click)="navigateBack()"
            />
            @if (isExpanded()) {
            <p class="fs-6 m-0">{{ submenuLabel }}</p>
            }
          </mat-toolbar>
          }
          <!-- Menu Items -->
          <div [@slideInOut]>
            <mat-nav-list>
              @for (item of currentLevel(); track $index) {
              <a
                mat-list-item
                [routerLink]="item.route"
                (click)="!item.route && navigateToSubMenu(item)"
                routerLinkActive="active-link"
                [routerLinkActiveOptions]="{ exact: false }"
              >
                <!-- icon -->
                @if (item.icon) {
                <mat-icon matListItemIcon>{{ item.icon }}</mat-icon>
                }

                <!-- expanded -->
                @if (isExpanded()) {
                <span matListItemTitle> {{ item.label }} </span>
                }

                <!-- children & expanded -->
                @if (item.children && isExpanded()) {
                <div matListItemMeta>
                  <mat-icon>chevron_right</mat-icon>
                </div>
                }
              </a>
              }
            </mat-nav-list>
          </div>
        </div>

        <!-- updates -->
        <div class="sidenav-group">
          <div class="sidenav-group-header">
            <mat-icon>update</mat-icon>
            <h6 class="sidenav-group-title">Updates</h6>
          </div>

          <mat-nav-list>
            <a
              mat-list-item
              [routerLink]="['/updates', 'smsInbox']"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{ exact: false }"
            >
              <mat-icon matListItemIcon>sms</mat-icon>
              <span matListItemTitle>SMS Inbox</span>
            </a>
            <a
              mat-list-item
              [routerLink]="['/updates', 'smsInbox']"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{ exact: false }"
            >
              <mat-icon matListItemIcon>notifications</mat-icon>
              <span matListItemTitle>In-App Notifications</span>
            </a>
          </mat-nav-list>
        </div>

        <!-- updates -->
        <div class="sidenav-group">
          <div class="sidenav-group-header">
            <!-- <mat-icon>update</mat-icon> -->
            <h6 class="sidenav-group-title">More Services</h6>
          </div>

          <mat-nav-list>
            <a
              mat-list-item
              [routerLink]="['/updates', 'smsInbox']"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{ exact: false }"
            >
              <mat-icon matListItemIcon>calendar_month_outline</mat-icon>
              <span matListItemTitle>Events</span>
            </a>
            <a
              mat-list-item
              [routerLink]="['/updates', 'smsInbox']"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{ exact: false }"
            >
              <mat-icon matListItemIcon>meeting_room</mat-icon>
              <span matListItemTitle>Group Meetings</span>
            </a>
            <a
              mat-list-item
              [routerLink]="['/updates', 'smsInbox']"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{ exact: false }"
            >
              <mat-icon matListItemIcon>help_center_outline</mat-icon>
              <span matListItemTitle>Help Center</span>
            </a>
          </mat-nav-list>
        </div>
      </div>

      <div class="sidenav-footer">
        <p class="fs-medium">&copy; Kipesa 2025</p>
      </div>
    </section>
  </mat-sidenav>

  <mat-sidenav-content class="d-flex flex-column overflow-hidden">
    <kps-app-bar (toggleSidenavChange)="sidenav.toggle()" />

    <section class="flex-grow-1 overflow-auto">
      <router-outlet></router-outlet>
    </section>
  </mat-sidenav-content>
</mat-sidenav-container>
